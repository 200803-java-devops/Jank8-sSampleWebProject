podTemplate(containers: [containerTemplate(name: 'maven', image: 'bensonre/jenkins-slave', ttyEnabled: true, command: 'cat')], volumes: [hostPathVolume(hostPath: '/var/run/docker.sock', mountPath: '/var/run/docker.sock')]) {
  node(POD_LABEL) {
      try{
        stage('Get a Maven project') {
            git 'https://github.com/200803-java-devops/Jank8-sSampleWebProject'
            container('maven') {
                stage('Build a Maven project') {
                    sh 'mvn clean package'
                }
                stage('docker'){
                     sh 'docker build -t jank8s/jenkins-sample .'
                     withCredentials([usernamePassword(credentialsId: 'docker_hub_credentials', passwordVariable: 'token', usernameVariable: 'username')]) {
                            sh 'docker login -u '+ username+' -p '+token
                            sh 'docker push jank8s/jenkins-sample'
                     }
                }
            }
            slackSend(color: '#BDFFC3', message: 'The build and Deployment is Successful')
        }
      }catch(e){
            slackSend(color: '#FF0000', message: 'The Build and Deployment Failed, Please Check Console')
            error "${e}"
      }
    }
}
